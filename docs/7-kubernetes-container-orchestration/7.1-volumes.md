# Volumes 

Unfortunatley, Kubernetes does not come with data persistence out of the box. For example, if a container in a pod crashes the kubelet will restart the container but with a clean state. The responsibility is on the developer to ensure that our applications have proper storage and data persistence. The [volume](https://kubernetes.io/docs/concepts/storage/volumes/) abstraction gives developers the ability to achieve those goals. At its core, a volume is a directory that stores data and is accessible to containers in a pod. There are three storage requirements that should be met: Storage should not depend on the pod lifecycle; Storage must be available on all nodes; Storage needs to survive even if a cluster crashes. 

In this section we will be exploring three different volume abstractions: Persistent volumes, persistent volume claims, and storage classes. 

### Persistent Volumes and Persistent Volume Claims

To help developers with storage and persisting data Kubernetes offers us two API resources: Persistent volumes and persistent volume claims. 

#### Persistent Volumes

A persistent volume is a cluster resource that is used to store data. When using PVs 


### Storage Class 


- Storage that doesn't depend on the pod lifecycle
- Storage must be avaliable on all nodes
- Storage needs to survive even if cluster crashes

- Volume
    - A directory with some data
    - These volumes are accessible in containers in a pod 
    - How made available, backed by which storage medium
    - Think of stroage as an external plugin to your cluster

- PV 
    - Cluster Resource
    - Needs actual physical storage
    - PVs not namespaced and accessible to whole cluster
    - Must be already in the cluster for a pod to use it 
- PVC
    - Application must claim the persistent volume 
    - Pods request the volume through the PV claim -> Claim then tries to find volume in cluster that satisfies the claim -> Volume has the actual storage backend 
    - Claims must exist in the same namespace as the pod using the claim
    - Once the pod finds the matching PV through the PVC the volume is then mounted into the pod and then that volume can be mounted into the container in that pod

- Storage Class
    - Provisions persistent volumes dynamically when a pvc claims it
    - each storage backend has its own provisoner 
    - Another abstraction level 
    - Requested by PVC -> 
    
- ConfigMap and Secrets 
    - Both are local volumes, these two are not created by PV or PVC
    - Managed by Kubernetes itself
    - 
- Terms - pv, pvc

- Start off - introduce exercise (mongo) - configuring a mongo instance

- PV

- Create a pod which mounts the PV ?

- Create pod which mounts the volume using the PVC

- Create a stateful set which creates a persistent volume claim by defining a persistent claim template 

- Service setup

- PV
