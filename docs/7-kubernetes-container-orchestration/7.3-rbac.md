*** TODO - BACKGROUND ON RBAC ***

Grant new permissions to the ServiceAccount

1. Create a namespace imperatively for jenkins with aid of the "kubectl create --help" command.

2. Install jenkins in the new "jenkins" namespace using helm.
helm repo add jenkins https://charts.jenkins.io
helm repo update
helm install jenkins jenkins/jenkins -n jenkins --version 3.9.3
 - The name of the chart is jenkins/jenkins - found by running `helm search repo jenkins`.

3. Discovery
After installing the jenkins helm chart, what new roles did it add in the "jenkins" namespace? Role bindings? Any service accounts?

4. Create credentials using a kubernetes secret. Replace the values for username and password with your own:

apiVersion: v1
kind: Secret
metadata:
# this is the jenkins id
  name: liatrio-jenkins-secret
  namespace: jenkins
  labels:
# secret type
    "jenkins.io/credentials-type": "usernamePassword"
  annotations:
# description - can not be a label as spaces are not allowed
    "jenkins.io/credentials-description" : "credentials from Kubernetes"
type: Opaque
stringData:
  username: YOUR_USERNAME
  password: 'YOUR_PASSWORD'

5. Setup jenkins and install the "Kubernetes Credentials Provider" plugin. You should notice a kubernetes store appear under the "Credentials" section in Jenkins but your secret isn't visible. This is because jenkins does not have the ability to access kubernetes secrets like the one created above. Having jenkins detect this new secret will require giving it a new role and rolebinding in kubernetes.
![](img/before-secrets-rbac.png ':size=100x100')

5. Create a new role for jenkins named "jenkins-read-secrets" in the "jenkins" namespace to read kubernetes secrets. Use the labels and annotations specificed below. Give this role a rule to get/watch/list secrets.

Labels:
    app.kubernetes.io/component: jenkins-controller
    app.kubernetes.io/instance: jenkins
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: jenkins
    helm.sh/chart: jenkins-3.9.3

Annotations:
    meta.helm.sh/release-name: jenkins
    meta.helm.sh/release-namespace: jenkins

6. Create a rolebinding for your "jenkins-read-secrets" role in the "jenkins" namespace using the same name and annotations/labels as in the previous step. Specify the same ServiceAccount you found during the "Discovery" step.

7. Refresh the "Credentials" pages and you'll now be able to see your kubernetes secret in Jenkins.

____
Imperative RBAC 
Service accounts, (cluster) roles, and (cluster) role bindings can also be created imperatively.